<html>
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.0.0/react.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.0.0/react-dom.js"></script>
<script src="../lib/php_crud_api_transform.js"></script>
<script>
'use strict';

var PostList = React.createClass({
  displayName: 'PostList',

  render: function render() {
    var createItem = function createItem(item) {
      return React.createElement(
        'li',
        null,
        item.id,
        ', ',
        item.content
      );
    };
    return React.createElement(
      'ul',
      null,
      this.props.posts.map(createItem)
    );
  }
});

var myApplication = React.createClass({
  displayName: 'myApplication',

  getInitialState: function getInitialState() {
    return { posts: [] };
  },
  onChange: function onChange(e) {
    this.setState({ text: e.target.value });
  },
  
  componentDidMount: function() {
    $.post("http://localhost:8000/blog.php/posts", {user_id:1,category_id:1,content:"from react"});
	this.serverRequest = $.get("http://localhost:8000/blog.php/posts", function (result) {
      this.setState(result);
    }.bind(this));
  },

  componentWillUnmount: function() {
    this.serverRequest.abort();
  },
  
  handleSubmit: function handleSubmit(e) {
    e.preventDefault();
    var nextItems = this.state.items.concat([{ text: this.state.text, id: Date.now() }]);
    var nextText = '';
  },
  render: function render() {
    return React.createElement(
      'div',
      null,
      React.createElement(PostList, { posts: this.state.posts })
    );
  }
});
</script>
</head>
<body>
<div id="myApplication">Loading...</div>
<script>
ReactDOM.render(React.createElement(PostList, null), document.getElementById('myApplication'));
</script>
</body>
</html>
